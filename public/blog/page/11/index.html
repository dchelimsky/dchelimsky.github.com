
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>David Chelimsky</title>
  <meta name="author" content="David">

  
  <meta name="description" content="I&rsquo;m pleased to report that I&rsquo;m going to be presenting at QCon London in March. Aslak Hellesøy, Dr. Nic Williams, Kevin Clark and I have &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.davidchelimsky.net/blog/page/11">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="David Chelimsky" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43280332-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">David Chelimsky</a></h1>
  
    <h2>random thoughtlessness</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.davidchelimsky.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/slides">Slides</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/01/10/presenting-at-qcon-london/">Presenting at QCon London</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-01-10T00:29:30+01:00" pubdate data-updated="true">Jan 10<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m pleased to report that I&rsquo;m going to be presenting at <a href="http://qcon.infoq.com/london/conference/">QCon London</a> in March. <a href="http://aslakhellesoy.com">Aslak Hellesøy</a>, <a href="http://drnicacademy.com/who">Dr. Nic Williams</a>, <a href="http://glu.ttono.us/">Kevin Clark</a> and I have been invited to present about various aspects of <a href="http://qcon.infoq.com/london/tracks/show_track.jsp?trackOID=90">The Rise of Ruby</a>.</p>

<p>We&rsquo;ll also be running <a href="http://qcon.infoq.com/london/schedule/monday.jsp">tutorials on Monday</a>. Aslak and I will present <a href="http://qcon.infoq.com/london/presentation/Ruby+for+Java+%26+C%23+programmers">Ruby for Java and C# Programmers</a> and Dr. Nic will present on <a href="http://qcon.infoq.com/london/presentation/Rails">Rails</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/01/04/advanced-rails-recipes/">Advanced Rails Recipes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-01-04T18:01:24+01:00" pubdate data-updated="true">Jan 4<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m pleased to announce that my contribution to <a href="http://www.clarkware.com/about.html">Mike Clark&rsquo;s</a> new <a href="http://www.pragprog.com/titles/fr_arr">Advanced Rails Recipes</a> book has been accepted and released. <a href="http://www.pragprog.com/titles/fr_arr">The book</a> is available right now as a Beta PDF and includes dozens of delicious and nutritious recipes for enhancing your Rails applications and the process of developing them.</p>

<p>This is my first formal publication in the software world [1], and I couldn&rsquo;t be more pleased than to have it be a <a href="http://www.pragprog.com/titles">Pragmatic Bookshelf</a> [2] publication.</p>

<p>My recipe is entitled Describing Behaviour from the Outside-In With RSpec and it demonstrates the BDD approach to Rails apps starting with the view and working your way down to the controllers, models and database.</p>

<p>There is currently one other BDD recipe: Getting Started with BDD, which uses <a href="http://thoughtbot.com/projects/shoulda">shoulda</a>. There are also recipes for cooking up mocks, code coverage and html validity. And that&rsquo;s just the testing related recipes.</p>

<p>There are also dozens of recipes dealing with UI, search, email, console, REST, db enhancements and even more general design improvements.</p>

<p>Like the first <a href="http://www.pragprog.com/titles/fr_rr">Rails Recipes</a> book, this one is a must-have for any serious Rails developer who wants to take it up a notch in creating great web applications with Rails.</p>

<hr />

<p>[1] My first publication of any kind was back around 1980 when I was a young professional magician. The book is called, simply, <a href="http://www.magicproshop.com/coin-magic-book-richard-kaufman-p-4654.html">Coin Magic</a>, and is a must have for any serious coin magician who wants to take it up a notch (see a trend here?) in presenting awesome feats of magic with ordinary coins. Back then I went by my first and middle name, David Arthur.</p>

<p>[2] The <a href="http://www.pragprog.com/">Pragmatic Programmers</a> are also publishing my upcoming book with co-author <a href="http://blog.aslakhellesoy.com/">Aslak Hellesøy</a>, tentatively entitled Behaviour Driven Development in Ruby with RSpec.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/12/14/rspec-1-1/">RSpec 1.1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-12-14T07:54:52+01:00" pubdate data-updated="true">Dec 14<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The RSpec Development Team is pleased as glug (that&rsquo;s kind of like punch, but more festive) to announce RSpec-1.1.0.</p>

<p>Thanks to all who have contributed patches over the last few months. Big thanks to Dan North and Brian Takita for their important work on this release. Dan contributed his rbehave framework which is now the Story Runner. Brian patiently did a TON of refactoring around interoperability with Test::Unit, and the result is a much cleaner RSpec core, and a clean adapter model that gets loaded when Test::Unit is on the path.</p>

<p>RSpec 1.1 brings four significant changes for RSpec users:</p>

<ul>
<li><p>The RSpec Story Runner</p></li>
<li><p>Nested Example Groups</p></li>
<li><p>Support for Rails 2.0.1</p></li>
<li><p>Test::Unit interoperability</p></li>
</ul>


<h4>Story Runner</h4>

<p>The RSpec Story Runner is Dan North&rsquo;s rbehave framework merged into RSpec. The Story Runner is a framework for expressing high level requirements in the form of executable User Stories with Scenarios that represent Customer Acceptance Tests.</p>

<p>RSpec 1.1 also ships with a Ruby on Rails extension called RailsStory, which lets you write executable user stories for your rails apps as well.</p>

<h4>Nested Example Groups</h4>

<p>Now you can nest groups to organize things a bit better:</p>

<pre><code>&lt;code&gt;
describe RubyDeveloper do

before(:each) do
  @ruby_developer = RubyDeveloper.new
end

describe "using RSpec 1.1.0" do

  before(:each) do
    @ruby_developer.use_rspec('1.1.0')
  end

  it "should be able to nest example groups" do
    @ruby_developer.should be_able_to_nest_example_groups
  end

end

describe "using RSpec 1.0.1" do

  before(:each) do
    @ruby_developer.use_rspec('1.0.8')
  end

  it "should not be able to nest example groups" do
    @ruby_developer.should_not be_able_to_nest_example_groups
  end

end

end
&lt;/code&gt;
</code></pre>

<p>Running this outputs:</p>

<pre><code>RubyDeveloper using RSpec 1.1.0
- should be able to nest example groups

RubyDeveloper using RSpec 1.0.8
- should not be able to nest example groups
</code></pre>

<p>== Support for Rails 2.0.1</p>

<pre><code>gem install rails
rails myapp
ruby script/plugin install http://rspec.rubyforge.org/svn/tags/REL_1_1_0/rspec
ruby script/plugin install http://rspec.rubyforge.org/svn/tags/REL_1_1_0/rspec_on_rails
script/generate rspec
</code></pre>

<h4>Test::Unit Interoperability</h4>

<p>Contrary to popular belief, Spec::Rails, RSpec&rsquo;s Ruby on Rails plugin, has been a Test::Unit wrapper since the the 0.7 release in November of 2006. RSpec 1.1 ups the ante though, offering a smooth transition from Test::Unit to RSpec with or without Rails:</p>

<ol>
<li><p>Start with a TestCase:</p>

<p> <code>
 require &lsquo;test/unit&rsquo;</p>

<p> class TransitionTest &lt; Test::Unit::TestCase
 def test_should_be_smooth
   transition = Transition.new(
     :from => &ldquo;Test::Unit::TestCase&rdquo;,
     :to => &ldquo;Spec::ExampleGroup&rdquo;
   )
   assert_equal &ldquo;really smooth&rdquo;, transition.in_practice
 end
 end
 </code></p></li>
<li><p>Require &lsquo;spec&rsquo;</p>

<p> <code>
 require &lsquo;test/unit&rsquo;
 require &lsquo;spec&rsquo;</p>

<p> class TransitionTest &lt; Test::Unit::TestCase
 def test_should_be_smooth
   transition = Transition.new(
     :from => &ldquo;Test::Unit::TestCase&rdquo;,
     :to => &ldquo;Spec::ExampleGroup&rdquo;
   )
   assert_equal &ldquo;really smooth&rdquo;, transition.in_practice
 end
 end
 </code></p></li>
<li><p>Convert TestCase to ExampleGroup</p>

<p> <code>
 require &lsquo;test/unit&rsquo;
 require &lsquo;spec&rsquo;</p>

<p> describe &ldquo;transitioning from TestCase to ExampleGroup&rdquo; do
 def test_should_be_smooth
   transition = Transition.new(
     :from => &ldquo;Test::Unit::TestCase&rdquo;,
     :to => &ldquo;Spec::ExampleGroup&rdquo;
   )
   assert_equal &ldquo;really smooth&rdquo;, transition.in_practice
 end
 end
 </code></p></li>
<li><p>Convert test methods to examples</p>

<p> <code>
 require &lsquo;test/unit&rsquo;
 require &lsquo;spec&rsquo;</p>

<p> describe &ldquo;transitioning from TestCase to ExampleGroup&rdquo; do
 it &ldquo;should be smooth&rdquo; do
   transition = Transition.new(
     :from => &ldquo;Test::Unit::TestCase&rdquo;,
     :to => &ldquo;Spec::ExampleGroup&rdquo;
   )
   assert_equal &ldquo;really smooth&rdquo;, transition.in_practice
 end
 end
 </code></p></li>
<li><p>Convert assertions to expectations</p>

<p> <code>
 require &lsquo;test/unit&rsquo;
 require &lsquo;spec&rsquo;</p>

<p> describe &ldquo;transitioning from TestCase to ExampleGroup&rdquo; do
 it &ldquo;should be smooth&rdquo; do
   transition = Transition.new(
     :from => &ldquo;Test::Unit::TestCase&rdquo;,
     :to => &ldquo;Spec::ExampleGroup&rdquo;)
   transition.in_practice.should == &ldquo;really smooth&rdquo;
 end
 end
 </code></p></li>
<li><p>Un-require test/unit</p>

<p> <code>
 require &lsquo;spec&rsquo;</p>

<p> describe &ldquo;transitioning from TestCase to ExampleGroup&rdquo; do
 it &ldquo;should be smooth&rdquo; do
   transition = Transition.new(
     :from => &ldquo;Test::Unit::TestCase&rdquo;,
     :to => &ldquo;Spec::ExampleGroup&rdquo;
   )
   transition.in_practice.should == &ldquo;really smooth&rdquo;
 end
 end
 </code></p></li>
</ol>


<p>At every one of these steps after step 2, you can run the file with the ruby command and you&rsquo;ll be getting RSpec&rsquo;s developer friendly output. This means that you can transition things as gradually as you like: no wholesale changes.</p>

<p>That&rsquo;s the story. Thanks again to all who contributed and to all who continue do so.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/12/08/rubyconf-2007-talk/">RubyConf 2007 Talk</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-12-08T00:23:51+01:00" pubdate data-updated="true">Dec 8<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The RSpec/BDD talk that Dave Astels and I presented at RubyConf 2007 has been <a href="http://rubyconf2007.confreaks.com/d3t1p2_rspec.html">posted for your viewing pleasure</a>.</p>

<p>There are also a bunch of other RubyConf talks <a href="http://rubyconf2007.confreaks.com/">posted on the same site</a>.</p>

<p>One correction: In our talk, I said that the role/feature/reason story format came from Mike Cohn&rsquo;s book User Stories Applied. The real source was a project team at Connextra that Tim MacKinnon was a part of. Tim later joined Thoughtworks, where Dan North learned about it from Tim.</p>

<p>I did, in fact, learn about it from Mike Cohn, but it was at a talk he did at an Agile Conference a couple of summers back. I had also read his book, and somewhere in my head merged the talk and the book.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/11/29/nested-example-groups/">Nested Example Groups</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-11-29T09:58:18+01:00" pubdate data-updated="true">Nov 29<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since rspec first appeared on the scene, users have been asking for nested example groups. Well it has finally arrived. RSpec 1.1.0 will ship with support for nesting, so you&rsquo;ll be able to do things like this:</p>

<pre><code>&lt;code&gt;
describe RSpec do
before(:each) do
  @rspec = RSpec.new
end

describe "at release 1.0.8" do
  before(:each) do
    @rspec.version = "1.0.8"
  end

  it "should not support nested example groups" do
    @rspec.should_not support_nested_example_groups
  end
end

describe "at release 1.1.0" do
  before(:each) do
    @rspec.version = "1.1.0"
  end

  it "should support nested example groups" do
    @rspec.should support_nested_example_groups
  end
end
end
&lt;/code&gt;
</code></pre>

<p>This will output:</p>

<pre><code>RSpec at release 1.0.8
- should not support nested example groups

RSpec at release 1.1.0
- should support nested example groups
</code></pre>

<p>If you&rsquo;re using trunk, you can do this now with revision 3009 or later.</p>

<p>Happy nesting!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/11/06/before_action-after_action/">before_action/after_action</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-11-06T17:55:46+01:00" pubdate data-updated="true">Nov 6<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A while back there was either a feature request in the <a href="http://rubyforge.org/tracker/?group_id=797">rspec tracker</a>, or a suggestion on one of the <a href="http://rubyforge.org/pipermail/rspec-users/">rspec</a> <a href="http://rubyforge.org/pipermail/rspec-devel/">mailing</a> lists, for a feature to DRY up controller specs.</p>

<p>The idea was that this pattern feels a bit clunky:</p>

<pre><code>&lt;code&gt;describe PersonController, "handling failed POST to create" do
def do_post
  post :create, invalid_arguments
end

it "should redisplay the create form" do
  do_post
  response.should render_template("people/new")
end

it "should try to create a Person" do
  Person.should_receive(:create).with(invalid_arguments).and_return(false)
  do_post
end
end
&lt;/code&gt;
</code></pre>

<p>And it would be nice to have something that was more expressive using tags like this:</p>

<pre><code>&lt;code&gt;describe PersonController, "handling failed POST to create" do
def do_post
  post :create, invalid_arguments
end

it "should redisplay the create form", :after =&gt; :do_post do
  response.should render_template("people/new")
end

it "should try to create a Person", :before =&gt; :do_post do
  Person.should_receive(:create).with(invalid_arguments).and_return(false)
end
end
&lt;/code&gt;
</code></pre>

<p>I didn&rsquo;t add this to rspec_on_rails because I personally find it harder to read. It also doesn&rsquo;t support situations where you want to stub something before the action and then set a state-based expecation after the action.</p>

<p>But the problem is still present, and it would be nice to have something a bit less clunky.</p>

<p>Well &ndash; here&rsquo;s what I&rsquo;ve been experimenting with. This is NOT part of RSpec, and I may not want to include it in RSpec because I think it&rsquo;s somewhat particular to my personal style (as opposed to a style that I think is &ldquo;right&rdquo; for BDD), but it&rsquo;s easy enough to add to your own projects.</p>

<p>Here&rsquo;s what the specs look like:</p>

<pre><code>&lt;code&gt;describe PersonController, "handling failed POST to create" do
def do_post
  post :create, invalid_arguments
end

it "should redisplay the create form" do
  after_post do
    response.should render_template("people/new")
  end
end

it "should try to create a Person" do
  during_post do
    Person.should_receive(:create).with(invalid_arguments).and_return(false)
  end
end
end
&lt;/code&gt;
</code></pre>

<p>I really like this even though it actually turns out to be a bit more verbose. I think it speaks very clearly about what is going on &ndash; especially &ldquo;during_post&rdquo;, which describes very well when the Person.should_receive the :create message.</p>

<p>Here&rsquo;s the code in spec_helper.rb that supports this pattern:</p>

<pre><code>&lt;code&gt;[:get, :post, :put, :delete, :render].each do |action|
eval %Q{
  def before_#{action}
    yield
    do_#{action}
  end
  alias during_#{action} before_#{action}
  def after_#{action}
    do_#{action}
    yield
  end
}
end
&lt;/code&gt;
</code></pre>

<p>This supports controller and view specs (hence including :render).</p>

<p>Please try it out and let me know what you think.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/11/05/rubyconf-slides/">RubyConf slides</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-11-05T14:48:33+01:00" pubdate data-updated="true">Nov 5<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blog.davidchelimsky.net/files/BDDWithRspec.RubyConf.2007.pdf">Here are the slides</a> from the presentation that Dave Astels and I did at RubyConf 07.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/26/lessons-in-specing/">Lessons in Spec&#8217;ing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-26T16:30:14+02:00" pubdate data-updated="true">Oct 26<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Lesson: system calls in specs do stuff on your system. Be careful.</p>

<p>I was trying different things to understand why a spec was failing and, at one point, put a pending statement in a spec that generates a file and then deletes it. The statement that deletes the file is in an after(:each) block (which is guaranteed to run) and looks like this:</p>

<pre><code>&lt;code&gt;system(%Q|rm "#{dir}/#{filename}"|)&lt;/code&gt;
</code></pre>

<p>Imagine my horror when I saw this in the output:</p>

<pre><code>rm: /: is a directory
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/25/plain-text-stories-part-iii/">Plain Text Stories: Part III</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-25T11:52:20+02:00" pubdate data-updated="true">Oct 25<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here&rsquo;s the latest update to <a href="http://blog.davidchelimsky.net/articles/2007/10/21/story-runner-in-plain-english">Plain Text</a> <a href="/articles/2007/10/22/plain-text-stories-on-rails">Stories</a>. Effective r2789 in RSpec&rsquo;s trunk.</p>

<p>Step 1: Write a Story</p>

<pre><code>&lt;code&gt;Story: simple addition

As an accountant
I want to add numbers
So that I can count beans

Scenario: add one plus one
  Given an addend of 1
  And an addend of 1

  When the addends are added

  Then the sum should be 2
  And the corks should be popped

Scenario: add two plus five
  Given an addend of 2
  And an addend of 5

  When the addends are added

  Then the sum should be 7
&lt;/code&gt;
</code></pre>

<p>Step 2: Create Steps</p>

<pre><code>&lt;code&gt;# This creates steps for :addition
steps_for(:addition) do
Given("an addend of $addend") do |addend|
  @adder ||= Adder.new
  @adder &lt;&lt; addend.to_i
end
end

# This appends to them
steps_for(:addition) do
When("the addends are added")  { @sum = @adder.sum }
Then("the sum should be $sum") { |sum| @sum.should == sum.to_i }
end
&lt;/code&gt;
</code></pre>

<p>Step 3: Let her open the box … no, that&rsquo;s not it …</p>

<p>Step 3: Run the Story with the steps you want (adding any that are only for this story as you go).</p>

<pre><code>&lt;code&gt;with_steps_for :addition do
Then("the corks should be popped") {}
run 'path/to/story/file'
end
&lt;/code&gt;
</code></pre>

<p>Working with Rails?</p>

<pre><code>&lt;code&gt;with_steps_for :navigation do
run 'path/to/story/file', :type =&gt; RailsStory
end
&lt;/code&gt;
</code></pre>

<p>What about multiple groups of steps?</p>

<pre><code>&lt;code&gt;
with_steps_for :login, :navigation, :form_submissions do
run 'path/to/story/file'
end
&lt;/code&gt;
</code></pre>

<p>Coming soon to a computer near you … (as soon as you can &ldquo;seven up&rdquo;)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/23/plain-text-stories-on-rails/">Plain Text Stories on Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-23T06:43:24+02:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since my last post on <a href="http://blog.davidchelimsky.net/articles/2007/10/21/story-runner-in-plain-english">plain text stories</a>, there have already been a few improvements, not the least of which is that it will now work with Rails. Again, this is trunk (rev 2769+) only and experimental.</p>

<p>Here&rsquo;s a working example from an app that I&rsquo;m working on:</p>

<p>stories/login</p>

<pre><code>Story: registered user logs in
As a registered user
I want to have to log in
So that only other registered users can see my data

Scenario: user logs in and sees welcome page
  Given a user registered with login: foo and password: test
  When user logs in with login: foo and password: test
  Then user should see the welcome page

Scenario: user logs in with wrong password
  Given a user registered with login: foo and password: test
  When user logs in with login: foo and password: wrong
  Then user should see the login form
  And page should include text: There was an error logging in.

Scenario: user logs in with wrong login name
  Given a user registered with login: foo and password: test
  When user logs in with login: wrong and password: test
  Then user should see the login form
  And page should include text: There was an error logging in.
</code></pre>

<p>[Update: modified to use runner.steps instead of runner.step_matchers]</p>

<p>stories/login.rb</p>

<pre><code>&lt;code&gt;require File.join(File.dirname(__FILE__), *%w[helper])

run_story :type =&gt; RailsStory do |runner|
runner.steps &lt;&lt; LoginSteps.new
runner.steps &lt;&lt; NavigationSteps.new
runner.load File.expand_path(__FILE__).gsub(".rb","")
end
&lt;/code&gt;
</code></pre>

<p>Here&rsquo;s what&rsquo;s new in this example:</p>

<ul>
<li><p>run_story is added to the main object so you don&rsquo;t have to remember that silly path to the PlainTextStoryRunner which will undoutedbly change!</p></li>
<li><p>run_story accepts arguments, including an options hash, which it will pass to the constructor of the PlainTextStoryRunner (in this case, :type => RailsStory)</p></li>
<li><p>run_story yields the runner, which now supports a load method which you use to tell it where to find the plain text story file.</p></li>
<li><p>run_story … runs the story</p></li>
</ul>


<p>Keep your eyes peeled for more updates in the coming days.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/12/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/10/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/11/28/myron-marston-and-andy-lindeman-are-rspecs-new-project-leads/">Myron Marston and Andy Lindeman are RSpec&#8217;s new project leads</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/13/rspec-212-is-released/">rspec-2.12 is released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/09/22/agile-testing-and-bdd-exchange-2012-in-nyc/">Agile Testing and BDD eXchange 2012 in NYC</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/07/08/rspec-211-is-released/">rspec-2.11 is released!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/05/14/spec-smell-explicit-use-of-subject/">Spec smell: explicit use of subject</a>
      </li>
    
  </ul>
</section>

<section>
  
  <a href="https://github.com/dchelimsky">@dchelimsky</a> on GitHub
  
</section>

<section>
  <h1>Twitter</h1>
  <a class="twitter-timeline" href="https://twitter.com/dchelimsky" data-widget-id="368978242654330880">Tweets by @dchelimsky</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - David -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'davidchelimskysblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
